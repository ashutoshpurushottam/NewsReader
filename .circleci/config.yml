--- 
jobs: 
  build: 
    docker: 
      - 
        image: "circleci/android:api-28-node8-alpha"
    environment: 
      ANDROID_HOME: /usr/local/android-sdk-linux
      JVM_OPTS: "-Xmx3200m"
    steps: 
      - checkout
      - 
        run: 
          command: "rm local.properties"
          name: "remove local settings"
      - 
        restore_cache: 
          key: "jars-{{ checksum \"build.gradle\" }}-{{ checksum  \"app/build.gradle\" }}"
      - 
        run: 
          command: "chmod +x ./gradlew"
          name: "chmod permissions"
      - 
        run: 
          command: "./gradlew androidDependencies"
          name: "Download Dependencies"
          pre: 
            - "echo y | android update sdk --no-ui --all --filter \"platform-tools, tools\""
            - "echo y | android update sdk --no-ui --all --filter \"android-24, build-tools-25.0.2\""
            - "echo y | android update sdk --no-ui --all --filter \"extra-android-m2repository\""
            - "echo y | android update sdk --no-ui --all --filter \"extra-android-support\""
      - 
        save_cache: 
          key: "jars-{{ checksum \"build.gradle\" }}-{{ checksum  \"app/build.gradle\" }}"
          paths: 
            - ~/.gradle
      - 
        run: 
          command: "./gradlew testDebug"
          name: "Run Tests"
      - 
        store_artifacts: 
          destination: reports
          path: app/build/reports
      - 
        store_test_results: 
          path: app/build/test-result
    working_directory: ~/repo
version: 2